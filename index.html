<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hardware Outlet Leads Tracker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f9fafb;
            padding: 20px;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        .header {
            background: white;
            border-radius: 8px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 20px;
        }

        h1 {
            font-size: 24px;
            color: #111827;
            margin-bottom: 4px;
        }

        .subtitle {
            color: #6b7280;
            font-size: 14px;
        }

        .buttons {
            display: flex;
            gap: 8px;
        }

        .btn {
            padding: 10px 16px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .btn-primary {
            background: #2563eb;
            color: white;
        }

        .btn-primary:hover {
            background: #1d4ed8;
        }

        .btn-success {
            background: #16a34a;
            color: white;
        }

        .btn-success:hover {
            background: #15803d;
        }

        .btn-small {
            padding: 4px 8px;
            font-size: 12px;
        }

        .btn-edit {
            background: #eff6ff;
            color: #2563eb;
        }

        .btn-edit:hover {
            background: #dbeafe;
        }

        .btn-delete {
            background: #fef2f2;
            color: #dc2626;
        }

        .btn-delete:hover {
            background: #fee2e2;
        }

        .metrics {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
        }

        .metrics-row-2 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
            margin-top: 16px;
        }

        .metric-card {
            padding: 16px;
            border-radius: 8px;
        }

        .metric-card.blue {
            background: #eff6ff;
        }

        .metric-card.green {
            background: #f0fdf4;
        }

        .metric-card.purple {
            background: #faf5ff;
        }

        .metric-card.orange {
            background: #fff7ed;
        }

        .metric-card.red {
            background: #fef2f2;
        }

        .metric-card.teal {
            background: #f0fdfa;
        }

        .metric-value {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 4px;
        }

        .metric-card.blue .metric-value {
            color: #1e3a8a;
        }

        .metric-card.green .metric-value {
            color: #166534;
        }

        .metric-card.purple .metric-value {
            color: #6b21a8;
        }

        .metric-card.orange .metric-value {
            color: #9a3412;
        }

        .metric-card.red .metric-value {
            color: #991b1b;
        }

        .metric-card.teal .metric-value {
            color: #115e59;
        }

        .metric-label {
            font-size: 12px;
            color: #6b7280;
        }

        .table-container {
            background: white;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th {
            background: #f9fafb;
            padding: 12px 16px;
            text-align: left;
            font-size: 11px;
            font-weight: 600;
            color: #374151;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border-bottom: 1px solid #e5e7eb;
            white-space: nowrap;
        }

        td {
            padding: 12px 16px;
            border-bottom: 1px solid #f3f4f6;
            font-size: 13px;
        }

        tr:hover {
            background: #f9fafb;
        }

        input, select {
            width: 100%;
            padding: 6px 8px;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            font-size: 13px;
            min-width: 120px;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #2563eb;
        }

        .actions {
            display: flex;
            gap: 4px;
        }

        .badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
        }

        .badge-yes {
            background: #dcfce7;
            color: #166534;
        }

        .badge-no {
            background: #fee2e2;
            color: #991b1b;
        }

        .badge-large {
            background: #dbeafe;
            color: #1e40af;
        }

        .badge-medium {
            background: #e0e7ff;
            color: #4338ca;
        }

        .badge-small {
            background: #fef3c7;
            color: #92400e;
        }

        .badge-mega {
            background: #fae8ff;
            color: #86198f;
        }

        .badge-converted {
            background: #dcfce7;
            color: #166534;
        }

        .badge-lead {
            background: #f3f4f6;
            color: #374151;
        }

        .badge-contacted {
            background: #dbeafe;
            color: #1e40af;
        }

        .badge-negotiating {
            background: #fef3c7;
            color: #92400e;
        }

        .badge-lost {
            background: #fee2e2;
            color: #991b1b;
        }

        .convert-btn {
            padding: 8px 16px;
            border: 2px solid #16a34a;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            background: white;
            color: #16a34a;
            transition: all 0.2s;
        }

        .convert-btn:hover {
            background: #f0fdf4;
        }

        .convert-btn.converted {
            background: #16a34a;
            color: white;
        }

        .convert-btn.converted:hover {
            background: #15803d;
        }

        .guide {
            margin-top: 24px;
            background: #eff6ff;
            border-radius: 8px;
            padding: 16px;
            color: #1e3a8a;
            font-size: 13px;
        }

        .guide h3 {
            font-size: 14px;
            margin-bottom: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-top">
                <div>
                    <h1>Hardware Outlet Leads Tracker</h1>
                    <p class="subtitle">Track and manage hardware outlet leads across Kenya</p>
                </div>
                <div class="buttons">
                    <button class="btn btn-primary" onclick="addLead()">
                        <span>+</span> Add Lead
                    </button>
                    <button class="btn btn-success" onclick="downloadCSV()">
                        <span>↓</span> Download CSV
                    </button>
                </div>
            </div>

            <div class="metrics">
                <div class="metric-card blue">
                    <div class="metric-value" id="totalLeads">0</div>
                    <div class="metric-label">Total Outlets</div>
                </div>
                <div class="metric-card green">
                    <div class="metric-value" id="weldplusAware">0</div>
                    <div class="metric-label">Weldplus Aware</div>
                </div>
                <div class="metric-card purple">
                    <div class="metric-value" id="largeOutlets">0</div>
                    <div class="metric-label">Large/Mega Outlets</div>
                </div>
            </div>

            <div class="metrics-row-2">
                <div class="metric-card red">
                    <div class="metric-value" id="convertedSales">0</div>
                    <div class="metric-label">Converted to Sales</div>
                </div>
                <div class="metric-card teal">
                    <div class="metric-value" id="conversionRate">0%</div>
                    <div class="metric-label">Conversion Rate</div>
                </div>
                <div class="metric-card orange">
                    <div class="metric-value" id="topRegion">-</div>
                    <div class="metric-label">Top Region</div>
                </div>
            </div>
        </div>

        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Region</th>
                        <th>Area</th>
                        <th>Store Name</th>
                        <th>Contact Person</th>
                        <th>Mobile No.</th>
                        <th>Outlet Category</th>
                        <th>Brands Stocked</th>
                        <th>Purchase Frequency</th>
                        <th>Supplier Type</th>
                        <th>Distributor Name</th>
                        <th>Weldplus Awareness</th>
                        <th>Converted to Sale</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="leadsTable">
                </tbody>
            </table>
        </div>

        <div class="guide">
            <h3>About This Tracker:</h3>
            <p>This tracker helps you manage hardware outlet leads from your Google Form submissions. Add leads manually or export data from Google Sheets and import it here. Use the CSV export feature to backup your data or share with your team.</p>
        </div>
    </div>

    <script>
        let leads = [];
        let editingId = null;

        const regions = ['Nairobi Central', 'Nairobi East', 'Nairobi North', 'Nairobi West', 'Nairobi South', 'Mt Kenya Region', 'Eastern Region', 'Rift Valley Region', 'Western Region', 'Coast', 'Other'];
        const categories = ['Small', 'Medium', 'Large', 'Mega'];
        const brands = ['Weldplus', 'Simba', 'AGI', 'Maruthi', 'Hero', 'Fontarc'];
        const frequencies = ['Weekly', 'Twice per month', 'Monthly', 'Other'];
        const suppliers = ['Manufacturer', 'Distributor'];
        const awareness = ['Yes', 'No'];

        window.onload = function() {
            const saved = localStorage.getItem('hardwareOutletLeads');
            if (saved) {
                leads = JSON.parse(saved);
            } else {
                leads = [{
                    id: Date.now(),
                    date: new Date().toISOString().split('T')[0],
                    region: 'Nairobi Central',
                    area: 'CBD',
                    storeName: 'Sample Hardware Store',
                    contactPerson: 'John Kamau',
                    mobile: '+254712345678',
                    category: 'Medium',
                    brandsStocked: 'Simba, AGI',
                    frequency: 'Weekly',
                    supplier: 'Distributor',
                    distributorName: 'ABC Distributors',
                    weldplusAware: 'No',
                    converted: false
                }];
                saveLeads();
            }
            renderTable();
            updateMetrics();
        };

        function saveLeads() {
            localStorage.setItem('hardwareOutletLeads', JSON.stringify(leads));
        }

        function addLead() {
            const newLead = {
                id: Date.now(),
                date: new Date().toISOString().split('T')[0],
                region: 'Nairobi Central',
                area: '',
                storeName: '',
                contactPerson: '',
                mobile: '',
                category: 'Small',
                brandsStocked: '',
                frequency: 'Monthly',
                supplier: 'Distributor',
                distributorName: '',
                weldplusAware: 'No',
                converted: false
            };
            leads.push(newLead);
            editingId = newLead.id;
            saveLeads();
            renderTable();
            updateMetrics();
        }

        function deleteLead(id) {
            if (confirm('Delete this outlet lead?')) {
                leads = leads.filter(l => l.id !== id);
                saveLeads();
                renderTable();
                updateMetrics();
            }
        }

        function toggleEdit(id) {
            editingId = editingId === id ? null : id;
            renderTable();
        }

        function toggleConversion(id) {
            const lead = leads.find(l => l.id === id);
            if (lead) {
                lead.converted = !lead.converted;
                saveLeads();
                renderTable();
                updateMetrics();
            }
        }

        function updateLead(id, field, value) {
            const lead = leads.find(l => l.id === id);
            if (lead) {
                lead[field] = value;
                saveLeads();
                renderTable();
                updateMetrics();
            }
        }

        function renderTable() {
            const tbody = document.getElementById('leadsTable');
            tbody.innerHTML = '';

            leads.forEach(lead => {
                const isEditing = editingId === lead.id;
                const tr = document.createElement('tr');
                
                let categoryBadge = 'badge-small';
                if (lead.category === 'Large') categoryBadge = 'badge-large';
                else if (lead.category === 'Medium') categoryBadge = 'badge-medium';
                else if (lead.category === 'Mega') categoryBadge = 'badge-mega';

                tr.innerHTML = `
                    <td>${isEditing ? `<input type="date" value="${lead.date}" onchange="updateLead(${lead.id}, 'date', this.value)">` : lead.date}</td>
                    <td>${isEditing ? `<select onchange="updateLead(${lead.id}, 'region', this.value)">
                        ${regions.map(r => `<option ${lead.region === r ? 'selected' : ''}>${r}</option>`).join('')}
                    </select>` : lead.region}</td>
                    <td>${isEditing ? `<input value="${lead.area}" onchange="updateLead(${lead.id}, 'area', this.value)">` : lead.area || '-'}</td>
                    <td>${isEditing ? `<input value="${lead.storeName}" onchange="updateLead(${lead.id}, 'storeName', this.value)">` : lead.storeName || '-'}</td>
                    <td>${isEditing ? `<input value="${lead.contactPerson}" onchange="updateLead(${lead.id}, 'contactPerson', this.value)">` : lead.contactPerson || '-'}</td>
                    <td>${isEditing ? `<input value="${lead.mobile}" onchange="updateLead(${lead.id}, 'mobile', this.value)">` : lead.mobile || '-'}</td>
                    <td>${isEditing ? `<select onchange="updateLead(${lead.id}, 'category', this.value)">
                        ${categories.map(c => `<option ${lead.category === c ? 'selected' : ''}>${c}</option>`).join('')}
                    </select>` : `<span class="badge ${categoryBadge}">${lead.category}</span>`}</td>
                    <td>${isEditing ? `<input value="${lead.brandsStocked}" onchange="updateLead(${lead.id}, 'brandsStocked', this.value)" placeholder="e.g., Simba, AGI">` : lead.brandsStocked || '-'}</td>
                    <td>${isEditing ? `<select onchange="updateLead(${lead.id}, 'frequency', this.value)">
                        ${frequencies.map(f => `<option ${lead.frequency === f ? 'selected' : ''}>${f}</option>`).join('')}
                    </select>` : lead.frequency}</td>
                    <td>${isEditing ? `<select onchange="updateLead(${lead.id}, 'supplier', this.value)">
                        ${suppliers.map(s => `<option ${lead.supplier === s ? 'selected' : ''}>${s}</option>`).join('')}
                    </select>` : lead.supplier}</td>
                    <td>${isEditing ? `<input value="${lead.distributorName}" onchange="updateLead(${lead.id}, 'distributorName', this.value)">` : lead.distributorName || '-'}</td>
                    <td>${isEditing ? `<select onchange="updateLead(${lead.id}, 'weldplusAware', this.value)">
                        ${awareness.map(a => `<option ${lead.weldplusAware === a ? 'selected' : ''}>${a}</option>`).join('')}
                    </select>` : `<span class="badge ${lead.weldplusAware === 'Yes' ? 'badge-yes' : 'badge-no'}">${lead.weldplusAware}</span>`}</td>
                    <td style="text-align: center;">
                        <button class="convert-btn ${lead.converted ? 'converted' : ''}" onclick="toggleConversion(${lead.id})">
                            ${lead.converted ? '✓ Converted' : 'Mark as Sale'}
                        </button>
                    </td>
                    <td>
                        <div class="actions">
                            <button class="btn btn-small ${isEditing ? 'btn-success' : 'btn-edit'}" onclick="toggleEdit(${lead.id})">
                                ${isEditing ? '✓' : '✎'}
                            </button>
                            <button class="btn btn-small btn-delete" onclick="deleteLead(${lead.id})">✕</button>
                        </div>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function updateMetrics() {
            const total = leads.length;
            const weldplusAware = leads.filter(l => l.weldplusAware === 'Yes').length;
            const largeOutlets = leads.filter(l => l.category === 'Large' || l.category === 'Mega').length;
            const converted = leads.filter(l => l.converted === true).length;
            const conversionRate = total > 0 ? ((converted / total) * 100).toFixed(1) : 0;
            
            const regionCounts = {};
            leads.forEach(l => {
                regionCounts[l.region] = (regionCounts[l.region] || 0) + 1;
            });
            const topRegion = Object.keys(regionCounts).length > 0 
                ? Object.keys(regionCounts).reduce((a, b) => regionCounts[a] > regionCounts[b] ? a : b)
                : '-';

            document.getElementById('totalLeads').textContent = total;
            document.getElementById('weldplusAware').textContent = weldplusAware;
            document.getElementById('largeOutlets').textContent = largeOutlets;
            document.getElementById('convertedSales').textContent = converted;
            document.getElementById('conversionRate').textContent = conversionRate + '%';
            document.getElementById('topRegion').textContent = topRegion;
        }

        function downloadCSV() {
            const total = leads.length;
            const weldplusAware = leads.filter(l => l.weldplusAware === 'Yes').length;
            const weldplusUnaware = total - weldplusAware;
            const largeOutlets = leads.filter(l => l.category === 'Large' || l.category === 'Mega').length;
            const converted = leads.filter(l => l.converted === true).length;
            const conversionRate = total > 0 ? ((converted / total) * 100).toFixed(1) : 0;

            let csv = 'HARDWARE OUTLET LEADS TRACKER\n\n';
            csv += 'SUMMARY METRICS\n';
            csv += `Total Outlets,${total}\n`;
            csv += `Weldplus Aware,${weldplusAware}\n`;
            csv += `Weldplus Unaware,${weldplusUnaware}\n`;
            csv += `Large/Mega Outlets,${largeOutlets}\n`;
            csv += `Converted to Sales,${converted}\n`;
            csv += `Conversion Rate,${conversionRate}%\n\n`;
            
            csv += 'OUTLET DETAILS\n';
            csv += 'Date,Region,Area,Store Name,Contact Person,Mobile No.,Outlet Category,Brands Stocked,Purchase Frequency,Supplier Type,Distributor Name,Weldplus Awareness,Converted to Sale\n';
            
            leads.forEach(lead => {
                csv += `${lead.date},"${lead.region}","${lead.area}","${lead.storeName}","${lead.contactPerson}",${lead.mobile},${lead.category},"${lead.brandsStocked}",${lead.frequency},${lead.supplier},"${lead.distributorName}",${lead.weldplusAware},${lead.converted ? 'Yes' : 'No'}\n`;
            });

            csv += '\n\nBREAKDOWN BY REGION\n';
            const regionCounts = {};
            leads.forEach(l => {
                regionCounts[l.region] = (regionCounts[l.region] || 0) + 1;
            });
            Object.entries(regionCounts).forEach(([region, count]) => {
                csv += `${region},${count}\n`;
            });

            csv += '\n\nBREAKDOWN BY OUTLET CATEGORY\n';
            const categoryCounts = {};
            leads.forEach(l => {
                categoryCounts[l.category] = (categoryCounts[l.category] || 0) + 1;
            });
            Object.entries(categoryCounts).forEach(([category, count]) => {
                csv += `${category},${count}\n`;
            });

            csv += '\n\nCONVERSION BREAKDOWN\n';
            csv += `Converted,${converted}\n`;
            csv += `Not Converted,${total - converted}\n`;
            csv += `Conversion Rate,${conversionRate}%\n`;

            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `hardware_outlet_leads_${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
            window.URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>